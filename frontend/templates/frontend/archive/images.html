{% extends "frontend/base.html" %}
{% block b1 %}
<h3>Archive Images</h3>
<div class="text-right">
  <a class="btn btn-dark btn-lg mb-3 mr-2" href="/archive/list">Archive 리스트</a>
  <a class="btn btn-dark btn-lg mb-3" href="/archive/detail/{{archive_id}}">Archive 수정</a>
</div>
<div class="float-right">
  <a class="btn btn-dark btn-lg" href="/archive/image_create/{{archive_id}}">Image Card 생성</a>
</div>
{% endblock %}
{% block b2 %}

<div class="mx-5 row row-cols-4" id="image-list">
</div>

<script>
  var list = document.getElementById("image-list")
  var url = "/api/archive/image_list/{{archive_id}}/"

  function getImageList(){
    fetch(url, {
      method: 'get',
      headers: {
        'Content-type':'application/json'
      }
    })
    .then((resp) => resp.json())
    .then((data) => {
      console.log('data: ', data)

      for (var index in data) {
        var id = data[index]['id']
        var original_name = data[index]['original_name']
        var image_source = data[index]['image_source']
        var image = data[index]['image']

        var card = `
          <div class="col">
            <div class="card h-100">
              <img src=${image} height=200>
              <div class="card-body text-dark">
                <h5 class="card-title"><a href="/archive/image_detail/${id}">${original_name}</a></h5>
                <p class="card-text">${image_source}</p>
              </div>
            </div>
          </div>
        `
        list.innerHTML += card
        }
    })
    .catch(error => console.log(error))
  }

  getImageList()
</script>
{% endblock %}
